<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="master">
<div th:replace="layouts/navbar :: navbar"></div>

<br><br>

<head>
	<title>Botilleria Donde El Lito</title>
	<link rel="shortcut icon" th:href="@{/images/ico_boti.png}">
	<meta charset="utf-8">
	<!-- Latest compiled and minified CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
		integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
		integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
		crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
</head>

<body>
	<script type="text/javascript">
		$(function () {
			$('input[name="fechaFiltro"]').daterangepicker({
				opens: 'left'
			}, function (start, end, label) {
				console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
			});
		});
	</script>
	<main layout:fragment="contenido">
		<div class="col-12">
			<h1 class="p-2 bg-success text-white">DETALLES VENTAS</h1>
			<div th:classappend="'alert-' + (${clase != null} ? ${clase} : info)" th:if="${mensaje != null}"
				th:text="${mensaje}" class="alert">
			</div>
			<form th:action="@{/ventas/filtrar}" method="post" class="form-inline">
				<table class="table table-striped table-bordered">
					<tr>
						<td>

							<label>Seleccionar Fecha: &nbsp;</label><input type="text"  name="fechaFiltro" 
								id="fechaFiltro">
							<button type="submit" class="btn_filtrar">Filtrar</button>
							
						</td>
					</tr>
				</table>
			</form>
		<div>
			<h3 th:value="${fechasBusqueda}"></h3>
		</div>
			<div style="text-align: right;">
				<a th:href="@{/ventas/exportarExcel}">
					<img src="/images/excel.png" width="60" height="40"></img>
				</a>
			</div>
			<div class="table-responsive">
				<table class="table table-bordered">
					<thead>
						<tr>
							<th>Fecha</th>
							<th>SubTotal</th>
							<th>Descuento</th>
							<th>Total</th>
							<th>Productos</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="venta : ${ventas}">
							<td th:text="${venta.fechaYHora}"></td>
							<td th:text="${venta.total}"></td>
							<td th:text="${venta.descuento}"></td>
							<td th:text="${venta.total - venta.descuento}"></td>

							<td>
								<table class="table table-bordered">
									<thead>
										<tr>
											<th>Nombre</th>
											<th>CÃ³digo de barras</th>
											<th>Cantidad vendida</th>
											<th>Precio</th>
											<th>Total</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="producto : ${venta.productos}">
											<td th:text="${producto.nombre}"></td>
											<td th:text="${producto.codigo}"></td>
											<td th:text="${producto.cantidad}"></td>
											<td th:text="${producto.precio}"></td>
											<td th:text="${producto.total}"></td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</main>

</body>

</html>